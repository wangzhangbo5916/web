# 存储器

## 主存和Cache的地址映射方式

缓存的出现是为了弥补主存（RAM）与 CPU 之间的速度差异，提高数据访问速度。以下是主存与缓存的地址映射方式的一些主要概念：

### 1. 地址映射的基本概念
- **主存地址**: 表示数据在主存储器中的物理地址。
- **缓存地址**: 表示数据在缓存中的地址，缓存通常是用更快的存储介质实现的。

### 2. 地址映射方式
主存和缓存之间的映射方式主要有以下三种：

#### 1. 直接映射 (Direct Mapping)
- **描述**: 每个主存块（block）只能映射到缓存中的一个特定位置。
- **地址计算**:
  - 主存地址分为三部分：
    1. **标签 (Tag)**: 用于判断该位置是否存储了所需的数据。
    2. **索引 (Index)**: 确定缓存中的行。
    3. **块偏移 (Block Offset)**: 确定数据块中的具体字节。
- **优点**: 简单，硬件实现成本低。
- **缺点**: 可能造成较高的冲突失效（conflict miss），因为多个主存块可能映射到同一个缓存行。

#### 2. 全相联映射 (Fully Associative Mapping)
- **描述**: 任何主存块可以存储在缓存的任何位置。
- **地址计算**:
  - 主存地址：
    1. **标签 (Tag)**: 用于判断所需的数据是否在缓存中。
    2. **块偏移 (Block Offset)**: 确定数据块中的具体字节。
- **优点**: 最少的冲突失效，灵活性高。
- **缺点**: 硬件复杂，成本高，查找时间也相对较长。

#### 3. 组相联映射 (Set Associative Mapping)
- **描述**: 将缓存划分为多个组（set），每个组包含多个位置（行）。每个主存块可以映射到某个组中的任何位置。
- **地址计算**:
  - 主存地址分为三部分：
    1. **标签 (Tag)**: 用于检查该组中的数据。
    2. **组索引 (Set Index)**: 确定数据应该被存储在哪个组中。
    3. **块偏移 (Block Offset)**: 确定数据块中的具体字节。
- **优点**: 比直接映射减少了冲突失效，但比全相联映射更简单。
- **缺点**: 较复杂于直接映射，不如全相联映射灵活。

### 3. 性能比较
- **直接映射**: 快速实现，适用于简单应用，但面临较高的冲突失效。
- **全相联映射**: 最佳性能，不会有冲突失效，但成本高。
- **组相联映射**: 在灵活性和实现复杂度之间取得平衡。

## 内存

- **DRAM** 和 **SRAM** 是主要的内存类型，分别用于主存和缓存。
- **Cache** 是一种优化存储访问的高速缓存，通常由 SRAM 组成。
- **EEPROM** 用于保存需要保留数据的非易失性存储。

### 1. DRAM (动态随机存取存储器)
- **定义**: DRAM 是一种存储器类型，每个存储单元由一个电容和一个晶体管组成，存储数据的过程需要周期性地刷新数据。
- **特点**:
  - 存储密度高，成本相对低，适合大容量内存。
  - 速度较慢，访问时间较长。
  - 需要定期刷新，否则数据会丢失。
- **应用**: 常用于计算机主存储器、服务器和移动设备中。

### 2. SRAM (静态随机存取存储器)
- **定义**: SRAM 是一种静态内存，其存储单元由多个晶体管组成，不需要刷新。
- **特点**:
  - 速度快，访问时间短，适合高速缓存。
  - 功耗相对高，存储密度低，成本较高。
- **应用**: 常用于 CPU 缓存（如 L1、L2、L3 缓存）和嵌入式系统。

### 3. Cache (缓存)
- **定义**: 一种用于临时存储数据的高速存储器，通常位于 CPU 和主存储器之间，用于加速数据访问。
- **特点**:
  - 存取速度极快，通常比主内存快得多。
  - 体积小，容量比主内存小得多。
  - 分为 L1、L2、L3 缓存，层级结构。
  - 高速缓存(Cache)是随着CPU与主存之间的性能差距不断增大而引入的，其速度比主存快得多，所存储的内容是CPU近期可能会需要的信息，是主存内容的副本，因此CPU需要访问数据和读取指令时要先访问Cache，若命中则直接访问，若不命中再去访问主存。
  - 评价Cache性能的关键指标是Cache的命中率影响命中率的因素有其容量、替换算法、其组织方式等。Cache的命中率随容量的增大而提高
  - Cache的设置不以扩大主存容量为目的，事实上也没有扩大主存的容量。
- **应用**: 用于加速 CPU 的数据访问，减少处理器读取主存的延迟。

### 4. EEPROM (电可擦除可编程只读存储器)
- **定义**: EEPROM 是一种非易失性存储器，可以在不移除部件的情况下进行电擦除和编程。
- **特点**:
  - 非易失性，断电后数据不会丢失。
  - 可以被多次编程和擦除，但速度比 DRAM 和 SRAM 慢。
  - 寿命有限，通常有写入次数限制。
- **应用**: 常用于存储 BIOS、固件、配置信息和小型数据记录。
