# 存储器

## 存储器分类

### 存储系统中的存储器分类

存储器是计算机系统中不可或缺的组成部分，其性能和类型直接影响系统的整体效率。根据访问方式和寻址方式，存储器可以主要分为以下几类：

#### 1. 按访问方式分类

- **按地址访问的存储器**:
  这一类存储器依据独立的存储地址进行读写操作，每个存储位置都有唯一的地址。

- **按内容访问的存储器**:
  这种存储器通过数据的内容进行访问，而不依赖于特定的地址。

#### 2. 按寻址方式分类

- **随机存储器 (Random Access Memory, RAM)**:
  - **定义**: 随机存储器是可以对任何存储单元进行存入或读取操作的存储器。访问任何存储单元所需的时间是相同的，无论数据存储在哪里。这种类型的存储器支持快速随机访问。
  - **特点**: 速度快，适用于需要快速读写的数据，如计算机的主内存。

- **顺序存储器 (Sequentially Addressed Memory, SAM)**:
  - **定义**: 在顺序存储器中，访问数据所需的时间与数据所在的存储位置相关，通常需按顺序访问数据。典型的例子是磁带。
  - **特点**: 数据读取时需遵循顺序，速度较慢，适合数据存储量大、访问频率低的情况。

- **直接存储器 (Directly Addressed Memory, DAM)**:
  - **定义**: 直接存储器是介于随机存取和顺序存取之间的存储方式。通常情况下，可以随机访问磁道，但在一个磁道内，则是顺序寻址。
  - **特点**: 适用于硬盘等设备，允许在磁道间进行快速寻址，但同一磁道内的访问需要顺序处理。

#### 3. 相联存储器

- **相联存储器 (Content Addressable Memory, CAM)**:
  - **定义**: 相联存储器是一种按内容访问的存储器。当需要检索数据时，可以通过将数据或数据的一部分作为关键字，与存储器中的每个单元进行比较来查找匹配项。
  - **特点**: 适合用于高速查找，常用于路由器、缓存和数据库等应用中。

## 主存和Cache的地址映射方式

缓存的出现是为了弥补主存（RAM）与 CPU 之间的速度差异，提高数据访问速度。以下是主存与缓存的地址映射方式的一些主要概念：

### 1. 地址映射的基本概念
- **主存地址**: 表示数据在主存储器中的物理地址。
- **缓存地址**: 表示数据在缓存中的地址，缓存通常是用更快的存储介质实现的。

### 2. 地址映射方式
主存和缓存之间的映射方式主要有以下三种：

#### 1. 直接映射 (Direct Mapping)
- **描述**: 每个主存块（block）只能映射到缓存中的一个特定位置。
- **地址计算**:
  - 主存地址分为三部分：
    1. **标签 (Tag)**: 用于判断该位置是否存储了所需的数据。
    2. **索引 (Index)**: 确定缓存中的行。
    3. **块偏移 (Block Offset)**: 确定数据块中的具体字节。
- **优点**: 简单，硬件实现成本低。
- **缺点**: 可能造成较高的冲突失效（conflict miss），因为多个主存块可能映射到同一个缓存行。

#### 2. 全相联映射 (Fully Associative Mapping)
- **描述**: 任何主存块可以存储在缓存的任何位置。
- **地址计算**:
  - 主存地址：
    1. **标签 (Tag)**: 用于判断所需的数据是否在缓存中。
    2. **块偏移 (Block Offset)**: 确定数据块中的具体字节。
- **优点**: 最少的冲突失效，灵活性高。
- **缺点**: 硬件复杂，成本高，查找时间也相对较长。

#### 3. 组相联映射 (Set Associative Mapping)
- **描述**: 将缓存划分为多个组（set），每个组包含多个位置（行）。每个主存块可以映射到某个组中的任何位置。
- **地址计算**:
  - 主存地址分为三部分：
    1. **标签 (Tag)**: 用于检查该组中的数据。
    2. **组索引 (Set Index)**: 确定数据应该被存储在哪个组中。
    3. **块偏移 (Block Offset)**: 确定数据块中的具体字节。
- **优点**: 比直接映射减少了冲突失效，但比全相联映射更简单。
- **缺点**: 较复杂于直接映射，不如全相联映射灵活。

### 3. 性能比较
- **直接映射**: 快速实现，适用于简单应用，但面临较高的冲突失效。
- **全相联映射**: 最佳性能，不会有冲突失效，但成本高。
- **组相联映射**: 在灵活性和实现复杂度之间取得平衡。

## 内存

- **DRAM** 和 **SRAM** 是主要的内存类型，分别用于主存和缓存。
- **Cache** 是一种优化存储访问的高速缓存，通常由 SRAM 组成。
- **EEPROM** 用于保存需要保留数据的非易失性存储。

### 1. DRAM (动态随机存取存储器)
- **定义**: DRAM 是一种存储器类型，每个存储单元由一个电容和一个晶体管组成，存储数据的过程需要周期性地刷新数据。
- **特点**:
  - 存储密度高，成本相对低，适合大容量内存。
  - 速度较慢，访问时间较长。
  - 需要定期刷新，否则数据会丢失。
- **应用**: 常用于计算机主存储器、服务器和移动设备中。

### 2. SRAM (静态随机存取存储器)
- **定义**: SRAM 是一种静态内存，其存储单元由多个晶体管组成，不需要刷新。
- **特点**:
  - 速度快，访问时间短，适合高速缓存。
  - 功耗相对高，存储密度低，成本较高。
- **应用**: 常用于 CPU 缓存（如 L1、L2、L3 缓存）和嵌入式系统。

### 3. Cache (缓存)
- **定义**: 一种用于临时存储数据的高速存储器，通常位于 CPU 和主存储器之间，用于加速数据访问。
- **特点**:
  - 存取速度极快，通常比主内存快得多。
  - 体积小，容量比主内存小得多。
  - 分为 L1、L2、L3 缓存，层级结构。
  - 高速缓存(Cache)是随着CPU与主存之间的性能差距不断增大而引入的，其速度比主存快得多，所存储的内容是CPU近期可能会需要的信息，是主存内容的副本，因此CPU需要访问数据和读取指令时要先访问Cache，若命中则直接访问，若不命中再去访问主存。
  - 评价Cache性能的关键指标是Cache的命中率影响命中率的因素有其容量、替换算法、其组织方式等。Cache的命中率随容量的增大而提高
  - Cache的设置不以扩大主存容量为目的，事实上也没有扩大主存的容量。
- **应用**: 用于加速 CPU 的数据访问，减少处理器读取主存的延迟。

### 4. EEPROM (电可擦除可编程只读存储器)
- **定义**: EEPROM 是一种非易失性存储器，可以在不移除部件的情况下进行电擦除和编程。
- **特点**:
  - 非易失性，断电后数据不会丢失。
  - 可以被多次编程和擦除，但速度比 DRAM 和 SRAM 慢。
  - 寿命有限，通常有写入次数限制。
- **应用**: 常用于存储 BIOS、固件、配置信息和小型数据记录。

## 练习题

### 设用设用2KX4位的存储器芯片组成16KX8位的存储器(地址单元为0000H~3FFFH，每个芯片的地址空间连续)，则地址单元OB1FH所在芯片的最小地址编号为()。
您的分析基本正确。在使用 2K x 4 位的存储器芯片组成 16K x 8 位存储器的情况下，我们需要逐步确认每一部分。以下是详细的分析过程：

### 存储器配置

1. **存储器芯片规格**:
   - 每个芯片为 **2K x 4位**，即每个芯片具有2048个存储单元，每个存储单元为4位。
   - 每个芯片的容量为：
     \[
     2K \times 4 \text{ 位} = 2048 \text{ 位} = 256 \text{ 字节}
     \]

2. **目标存储器规格**:
   - 目标存储器为 **16K x 8位**，即需要 **16384个存储单元**，每个单元为8位。
   - 每个字节包含两个芯片的4位，因此需要：
     \[
     \frac{16K \times 8}{2K \times 4} = \frac{16 \times 8}{8} = 16
     \]
   - 这需要 **16片芯片**，是因为有两个芯片提供8位数据，存储器有8段的字节地址，可存储空间是：
    \[
     2K \times 8 \text{ 位} = 2^{11} = 8 \times 2^{8} = 8 \times 16^{2} = 0800H
     \]

### 地址范围

根据上述信息，储存器的地址空间可以分为如下地址范围：

- **每个芯片的地址范围为**：
  - 第 0 片: 0000H 到 07FFH (2048字节)
  - 第 1 片: 0800H 到 0FFFH
  - 第 2 片: 1000H 到 17FFH
  - 第 3 片: 1800H 到 1FFFH
  - 第 4 片: 2000H 到 27FFH
  - 第 5 片: 2800H 到 2FFFH
  - 第 6 片: 3000H 到 37FFH
  - 第 7 片: 3800H 到 3FFFH

### 确定地址单元 `0B1FH`

1. 将 `0B1FH` 转换为十进制：
   \[
   0B1FH = 0 \times 16^3 + 11 \times 16^2 + 1 \times 16^1 + 15 \times 16^0 = 0 + 256 + 16 + 15 = 287
   \]

2. 查找这个地址在芯片中的位置：
   - 根据地址范围：
     - 从地址 `0800H`（2048十进制）开始，`0B1FH` 地址落在 **第 1 片** 中。

### 默认最小地址

- 地址 `0800H` 是 **第 1 片的最小地址**。

### 结论

所以，地址单元 `0B1FH` 所在芯片的最小地址编号是 `0800H`。